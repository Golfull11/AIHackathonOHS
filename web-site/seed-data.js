import { Firestore } from '@google-cloud/firestore';

const firestore = new Firestore();
const COLLECTION_NAME = 'internal_cases';

// 9件のダミーデータ
const DUMMY_CASES = [
    { occurredAt: new Date("2024-03-15T10:30:00"), title: "事務所の階段での転倒による打撲", description: "書類を両手で持って階段を降りている際、足元が見えにくく、最後の一段を踏み外して転倒。右腕を打撲した。", cause: "両手が塞がっていたため手すりを持てず、視界も不良だった。階段の端に滑り止めの設置がなかった。", measures: "階段の昇降時は、片手を空けて必ず手すりを持つことを徹底する。階段のフチに、視認性の高い滑り止めテープを貼付する。" },
    { occurredAt: new Date("2024-06-20T14:00:00"), title: "フォークリフトのバッテリー交換中の軽度の感電（ヒヤリハット）", description: "バッテリー交換作業中、濡れた手で端子に触れてしまい、ピリッとした軽い衝撃を感じた。怪我はなかった。", cause: "絶縁保護手袋を着用していなかった。作業前に、バッテリー周辺の水分を拭き取る手順が徹底されていなかった。", measures: "バッテリー交換作業時は、必ず規定の絶縁保護手袋を着用する。作業手順書に、作業前の周辺確認（水分など）の項目を追加し、周知徹底する。" },
    { occurredAt: new Date("2024-11-05T15:15:00"), title: "喫煙所での吸い殻の不始末による小火", description: "喫煙所の吸い殻入れが満杯になっており、溢れた吸い殻が近くの段ボールに燃え移り、煙が上がった。すぐに消火器で消し止め、大事には至らなかった。", cause: "吸い殻入れの定期的な清掃・管理が不十分だった。可燃物（段ボール）が喫煙所の近くに置かれていた。", measures: "喫煙所の清掃担当と周期を明確にし、記録を残す。喫煙所の周囲5メートル以内には可燃物を置かないルールを策定し、表示する。" },
    { occurredAt: new Date("2025-01-22T09:45:00"), title: "重量物（部品箱）の持ち上げによる腰痛の発生", description: "床に置かれた25kgの部品箱を、一人で無理な姿勢で持ち上げようとした際に、腰に鋭い痛みを感じた。", cause: "重量物取り扱いの基本（膝を曲げて腰を落とす）が守られていなかった。20kg以上の荷物を一人で運搬することを黙認していた。", measures: "重量物取り扱いの安全教育を再実施する。2人での運搬を原則とし、必要な場合は台車やリフターを使用するルールを徹底する。" },
    { occurredAt: new Date("2024-02-10T11:00:00"), title: "保護メガネ未着用による洗浄剤の飛沫目に入る事故", description: "部品の油汚れを洗浄剤で洗い流している際、ブラシから洗浄剤の飛沫が跳ね、目に入った。すぐに洗い流したが、軽い炎症を起こした。", cause: "保護メガネの着用が義務付けられていたが、短時間の作業だと思い、着用を怠った。", measures: "化学薬品を取り扱う全ての作業エリアで、保護メガネの着用を必須とし、未着用者には厳しく指導する。緊急洗眼器の場所を再周知する。" },
    { occurredAt: new Date("2024-09-03T16:20:00"), title: "脚立の天板に乗って作業中の転落", description: "照明器具の交換のため、脚立の最上段（天板）に乗り、不安定な体勢で作業していたところ、バランスを崩して床に転落。足首を捻挫した。", cause: "脚立の天板に乗ってはいけないという、基本的なルールが守られていなかった。より高さのある適切な脚立を使用しなかった。", measures: "脚立の正しい使い方に関するステッカーを目立つ場所に貼り、危険な使い方をしないよう注意喚起する。作業高さに応じた適切なサイズの脚立を使用することを徹底させる。" },
    { occurredAt: new Date("2025-04-18T13:50:00"), title: "電動ドリルのキックバックによる手首の捻挫", description: "金属板に穴を開ける作業中、ドリルが噛み込み、本体が回転する「キックバック」が発生。ドリルを支えていた左手首をひねってしまった。", cause: "対象物に対して、ドリルの回転数が速すぎた。キックバックの危険性を十分に認識せず、両手でしっかりと保持していなかった。", measures: "作業前に、材質に応じた適切な回転数に設定するよう指導する。サイドハンドル付きのドリルを使用し、必ず両手で保持して作業するよう教育する。" },
    { occurredAt: new Date("2024-08-07T14:30:00"), title: "夏場の屋外倉庫での作業中にめまい（熱中症の初期症状）", description: "8月の昼過ぎ、換気の悪い屋外倉庫で荷物の整理をしていた際、急なめまいと立ちくらみを感じ、作業を中断して休憩した。", cause: "定期的な水分・塩分補給を怠っていた。倉庫内の温度・湿度を把握しておらず、休憩のタイミングが管理されていなかった。", measures: "夏場の作業中は、30分に1回の休憩と水分補給を義務付ける。倉庫内に温湿度計と大型扇風機を設置する。熱中症対策のポスターを掲示する。" },
    { occurredAt: new Date("2024-05-25T10:10:00"), title: "カッターナイフ使用中の指の切り傷", description: "段ボールの開梱作業中、カッターの刃を長く出しすぎていたため、刃が滑って左手の親指を切ってしまった。", cause: "カッターナイフの刃を必要以上に出して使用していた。対象物に対して手を添える位置が不適切だった。", measures: "カッターナイフは、刃を一目盛りだけ出して使用するルールを徹底する。切創防止手袋の着用を推奨する。" }
];

async function main() {
    console.log("Seeding 9 dummy data to Firestore...");
    const collectionRef = firestore.collection(COLLECTION_NAME);
    
    // バッチ処理で一括書き込み
    const batch = firestore.batch();

    DUMMY_CASES.forEach(caseData => {
        const docRef = collectionRef.doc(); // 新しいドキュメントIDを自動生成
        batch.set(docRef, {
            ...caseData,
            createdAt: new Date() // 登録日時を自動付与
        });
    });

    try {
        await batch.commit();
        console.log("Successfully seeded 9 documents to Firestore.");
        console.log("Cloud Function will now automatically export them to Cloud Storage.");
    } catch (error) {
        console.error("Error seeding data:", error);
    }
}

main();